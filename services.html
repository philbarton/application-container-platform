


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.1.7">
    
    
      
        <title>Services - Application Container Platform</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.4c7052ca.min.css">
      
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    <body dir="ltr">
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#vpn" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="." title="Application Container Platform" class="md-header-nav__button md-logo" aria-label="Application Container Platform">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Application Container Platform
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Services
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="Application Container Platform" class="md-nav__button md-logo" aria-label="Application Container Platform">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Application Container Platform
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="index.html" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Services
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"/></svg>
        </span>
      </label>
    
    <a href="services.html" title="Services" class="md-nav__link md-nav__link--active">
      Services
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#vpn" class="md-nav__link">
    VPN
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#source-code-management" class="md-nav__link">
    Source Code Management
  </a>
  
    <nav class="md-nav" aria-label="Source Code Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#github" class="md-nav__link">
    GitHub
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gitlab" class="md-nav__link">
    GitLab
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ci" class="md-nav__link">
    CI
  </a>
  
    <nav class="md-nav" aria-label="CI">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#drone" class="md-nav__link">
    Drone
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jenkins" class="md-nav__link">
    Jenkins
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#binary-artefact-storage" class="md-nav__link">
    Binary / Artefact Storage
  </a>
  
    <nav class="md-nav" aria-label="Binary / Artefact Storage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quay" class="md-nav__link">
    Quay
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ecr" class="md-nav__link">
    ECR
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifactory" class="md-nav__link">
    Artifactory
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#domain-name-system-dns-pattern" class="md-nav__link">
    Domain Name System (DNS) Pattern
  </a>
  
    <nav class="md-nav" aria-label="Domain Name System (DNS) Pattern">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#for-non-production-services" class="md-nav__link">
    For Non-production Services
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#for-production-services" class="md-nav__link">
    For Production Services
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#application-composition" class="md-nav__link">
    Application Composition
  </a>
  
    <nav class="md-nav" aria-label="Application Composition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#keycloak-gatekeeper" class="md-nav__link">
    Keycloak Gatekeeper
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nginx-proxy" class="md-nav__link">
    Nginx Proxy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cert-manager" class="md-nav__link">
    cert-manager
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#logging" class="md-nav__link">
    Logging
  </a>
  
    <nav class="md-nav" aria-label="Logging">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#current-log-retention-policy" class="md-nav__link">
    Current Log Retention Policy
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metrics-monitoring" class="md-nav__link">
    Metrics / Monitoring
  </a>
  
    <nav class="md-nav" aria-label="Metrics / Monitoring">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sysdig" class="md-nav__link">
    Sysdig
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sysdig-training" class="md-nav__link">
    Sysdig training
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-and-disaster-recovery" class="md-nav__link">
    Security and disaster recovery
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reusable-components" class="md-nav__link">
    Reusable components
  </a>
  
    <nav class="md-nav" aria-label="Reusable components">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#terraform-modules" class="md-nav__link">
    Terraform modules
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#base-docker-images" class="md-nav__link">
    Base docker images
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="https://gitlab.digital.homeoffice.gov.uk/acp-docs/acp-support/tree/master/release-notes/" title="Release Notes" class="md-nav__link">
      Release Notes
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="how-to-docs/index.html" title="How To's" class="md-nav__link">
      How To's
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="developer-docs/index.html" title="Developer Getting Started Guide" class="md-nav__link">
      Developer Getting Started Guide
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="newuser.html" title="New User Guide" class="md-nav__link">
      New User Guide
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="rbac.html" title="RBAC Guide" class="md-nav__link">
      RBAC Guide
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="external-addresses.html" title="ACP External IPs" class="md-nav__link">
      ACP External IPs
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="service-lifecycle.html" title="Service Lifecycle" class="md-nav__link">
      Service Lifecycle
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#vpn" class="md-nav__link">
    VPN
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#source-code-management" class="md-nav__link">
    Source Code Management
  </a>
  
    <nav class="md-nav" aria-label="Source Code Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#github" class="md-nav__link">
    GitHub
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gitlab" class="md-nav__link">
    GitLab
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ci" class="md-nav__link">
    CI
  </a>
  
    <nav class="md-nav" aria-label="CI">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#drone" class="md-nav__link">
    Drone
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jenkins" class="md-nav__link">
    Jenkins
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#binary-artefact-storage" class="md-nav__link">
    Binary / Artefact Storage
  </a>
  
    <nav class="md-nav" aria-label="Binary / Artefact Storage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quay" class="md-nav__link">
    Quay
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ecr" class="md-nav__link">
    ECR
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifactory" class="md-nav__link">
    Artifactory
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#domain-name-system-dns-pattern" class="md-nav__link">
    Domain Name System (DNS) Pattern
  </a>
  
    <nav class="md-nav" aria-label="Domain Name System (DNS) Pattern">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#for-non-production-services" class="md-nav__link">
    For Non-production Services
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#for-production-services" class="md-nav__link">
    For Production Services
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#application-composition" class="md-nav__link">
    Application Composition
  </a>
  
    <nav class="md-nav" aria-label="Application Composition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#keycloak-gatekeeper" class="md-nav__link">
    Keycloak Gatekeeper
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nginx-proxy" class="md-nav__link">
    Nginx Proxy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cert-manager" class="md-nav__link">
    cert-manager
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#logging" class="md-nav__link">
    Logging
  </a>
  
    <nav class="md-nav" aria-label="Logging">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#current-log-retention-policy" class="md-nav__link">
    Current Log Retention Policy
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metrics-monitoring" class="md-nav__link">
    Metrics / Monitoring
  </a>
  
    <nav class="md-nav" aria-label="Metrics / Monitoring">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sysdig" class="md-nav__link">
    Sysdig
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sysdig-training" class="md-nav__link">
    Sysdig training
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-and-disaster-recovery" class="md-nav__link">
    Security and disaster recovery
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reusable-components" class="md-nav__link">
    Reusable components
  </a>
  
    <nav class="md-nav" aria-label="Reusable components">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#terraform-modules" class="md-nav__link">
    Terraform modules
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#base-docker-images" class="md-nav__link">
    Base docker images
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  
                
                
                  <h1>Services</h1>
                
                <p>These are the core services which we provide across our platform.</p>
<h2 id="vpn">VPN<a class="headerlink" href="#vpn" title="Permanent link">#</a></h2>
<p>Many of our services are behind a VPN (using <a href="https://wiki.archlinux.org/index.php/OpenVPN">OpenVPN</a> protocol) for security reasons. We have many different roles and profiles for accessing different environments. These profiles are all found at <a href="https://access-acp.digital.homeoffice.gov.uk">Access ACP</a>.
You can download VPN profiles for the environments you have access to. New profiles can be set up to connect through to things like project specific AWS accounts.
Each profile will expire after a certain amount of time (8-72 hours), users will have to download a new profile once their certificates which are baked into the openvpn profiles expire.</p>
<h2 id="source-code-management">Source Code Management<a class="headerlink" href="#source-code-management" title="Permanent link">#</a></h2>
<h4 id="github">GitHub<a class="headerlink" href="#github" title="Permanent link">#</a></h4>
<p>GitHub is where we store our open source code. You need to be added to the Uk HomeOffice organisation to access most of our code. More documentation can be found <a href="https://help.github.com/">here</a></p>
<h4 id="gitlab">GitLab<a class="headerlink" href="#gitlab" title="Permanent link">#</a></h4>
<p><a href="https://gitlab.digital.homeoffice.gov.uk">GitLab</a> is where we store our more private code. Hosted in our ops cluster, you will need an office 365 account to get in via single sign on. Each project has its own group which are managed by members of that project. More in depth guides to gitlab can be found <a href="https://docs.gitlab.com/ce/README.html">here</a>.</p>
<h2 id="ci">CI<a class="headerlink" href="#ci" title="Permanent link">#</a></h2>
<h4 id="drone">Drone<a class="headerlink" href="#drone" title="Permanent link">#</a></h4>
<p>Drone is our CI tool for building and deploying applications. We have two instances, one for <a href="https://drone-gitlab.acp.homeoffice.gov.uk">GitLab</a> and one for <a href="https://drone.acp.homeoffice.gov.uk">GitHub</a>. More instructions can be found <a href="how-to-docs/drone-how-to.html">here</a>.</p>
<h4 id="jenkins">Jenkins<a class="headerlink" href="#jenkins" title="Permanent link">#</a></h4>
<p>Jenkins is considered a legacy system and is not supported.</p>
<h2 id="binary-artefact-storage">Binary / Artefact Storage<a class="headerlink" href="#binary-artefact-storage" title="Permanent link">#</a></h2>
<h4 id="quay">Quay<a class="headerlink" href="#quay" title="Permanent link">#</a></h4>
<p><a href="https://quay.io/ukhomeofficedigital">Quay</a> is where store all of our open source container images.</p>
<h4 id="ecr">ECR<a class="headerlink" href="#ecr" title="Permanent link">#</a></h4>
<p>We use AWS ECR to host our private container images for high availability and resiliency. For more information on how to use ECR see <a href="how-to-docs/drone-how-to.html">here</a></p>
<h4 id="artifactory">Artifactory<a class="headerlink" href="#artifactory" title="Permanent link">#</a></h4>
<p>We use <a href="https://artifactory.digital.homeoffice.gov.uk">Artifactory</a> as our internal binary repository store where projects can push build time artefacts and dependencies. Prior to the introduction of ECR, Docker images were also pushed here and can be accessed via https://docker.digital.homeoffice.gov.uk. Please note that we regularly remove container images that have not been downloaded in a year.</p>
<h2 id="domain-name-system-dns-pattern">Domain Name System (DNS) Pattern<a class="headerlink" href="#domain-name-system-dns-pattern" title="Permanent link">#</a></h2>
<p>To standardise on how services route their application traffic to the appropriate hosting platform and to offer consistency in how we approach DNS we have a standard DNS naming convention for services.</p>
<p>In parallel to this, users need to also be aware of <a href="https://letsencrypt.org/docs/rate-limits/">the limits on certificates and letsencrypt</a> if they are wanting external TLS certificates for their services.</p>
<h4 id="for-non-production-services">For Non-production Services<a class="headerlink" href="#for-non-production-services" title="Permanent link">#</a></h4>
<p>The following categories are something we would expect a service to specify:</p>
<p><code>Service Name</code> - The name of the service users or other services will attempt to consume i.e. <code>web-portal</code></p>
<p><code>Env</code> - The environment of the service i.e. <code>Dev</code></p>
<p><code>Service</code> - The overall service name or project name i.e. <code>example-service</code></p>
<pre><code>&lt;servicename&gt;.&lt;env&gt;.&lt;service&gt;-notprod.homeoffice.gov.uk

web-portal.dev.example-service-notprod.homeoffice.gov.uk
</code></pre>

<h4 id="for-production-services">For Production Services<a class="headerlink" href="#for-production-services" title="Permanent link">#</a></h4>
<p>As we want to protect production services from hitting limits and to create a distinction between services that are non-production, (not prod)  and production, we simplify the overall approach by using the main service name as the domain.</p>
<p><code>Service Name</code> - The name of the service users or other services will attempt to consume i.e. <code>web-portal</code></p>
<p><code>Service</code> - The overall service name or project name i.e. <code>example-service</code></p>
<pre><code>&lt;servicename&gt;.&lt;service&gt;.homeoffice.gov.uk

web-portal.example-service.homeoffice.gov.uk
</code></pre>

<h2 id="application-composition">Application Composition<a class="headerlink" href="#application-composition" title="Permanent link">#</a></h2>
<p>The following are containers that we create for use alongside your own application</p>
<h4 id="keycloak-gatekeeper">Keycloak Gatekeeper<a class="headerlink" href="#keycloak-gatekeeper" title="Permanent link">#</a></h4>
<p><a href="https://github.com/keycloak/keycloak-gatekeeper">Keycloak Proxy</a>: a container for putting auth in front of your application.</p>
<h4 id="nginx-proxy">Nginx Proxy<a class="headerlink" href="#nginx-proxy" title="Permanent link">#</a></h4>
<p><a href="https://github.com/UKHomeOffice/docker-nginx-proxy">Nginx Proxy</a>: for TLS and proxying your application container.</p>
<h4 id="cert-manager">cert-manager<a class="headerlink" href="#cert-manager" title="Permanent link">#</a></h4>
<p><a href="how-to-docs/cert-manager.html">Cert-manager</a>: for obtaining internal and external certificates.</p>
<h2 id="logging">Logging<a class="headerlink" href="#logging" title="Permanent link">#</a></h2>
<p>Logging stack consists of <a href="https://github.com/UKHomeOffice/docker-elasticsearch">Elasticsearch</a>, <a href="https://github.com/UKHomeOffice/docker-logstash-kubernetes">Logstash</a>, <a href="https://github.com/UKHomeOffice/docker-kibana">Kibana</a>).</p>
<ul>
<li>Logstash agents deployed as a daemonSet will collect all workload logs and index them in Elasticsearch.</li>
<li>Logs are searchable for a period of 5 days through <a href="https://kibana.acp.homeoffice.gov.uk">Kibana UI</a>. Access to view logs can be requested via <a href="https://support.acp.homeoffice.gov.uk/servicedesk/customer/portal/1/create/34">Support request</a>.</li>
</ul>
<h4 id="current-log-retention-policy">Current Log Retention Policy<a class="headerlink" href="#current-log-retention-policy" title="Permanent link">#</a></h4>
<ul>
<li>Logs are searchable in Kibana for 5 days and remain within Elasticsearch for 10 days.</li>
<li>Collected workload logs will be persisted in S3 indefinitely and migrated to the infrequent access storage class and then glacier storage after 60 and 180 days respectively. <strong>NOTE: this may change in the future!</strong></li>
<li>The same policy applies to all logs within ELK</li>
</ul>
<h2 id="metrics-monitoring">Metrics / Monitoring<a class="headerlink" href="#metrics-monitoring" title="Permanent link">#</a></h2>
<h4 id="sysdig">Sysdig<a class="headerlink" href="#sysdig" title="Permanent link">#</a></h4>
<p><a href="https://sysdig.digital.homeoffice.gov.uk">Sysdig</a> is our metric collection tool. We are working closely with Sysdig on the development of this. It can be used for dashboards, alerting and much more. More information can be found on the <a href="https://sysdig.com">Sysdig Monitor site</a> and for the open-source tool, <a href="http://sysdig.org">Sysdig</a> (command line tool) and <a href="https://github.com/draios/sysdig-inspect">Sysdig Inspect</a>.</p>
<h4 id="sysdig-training">Sysdig training<a class="headerlink" href="#sysdig-training" title="Permanent link">#</a></h4>
<p>Sysdig have an online training course which covers the basics of using the product, <a href="https://sysdig.teachable.com/">Sysdig 101</a>. Sysdig recommends new users complete this training.</p>
<h2 id="security-and-disaster-recovery">Security and disaster recovery<a class="headerlink" href="#security-and-disaster-recovery" title="Permanent link">#</a></h2>
<p>The Application Container Platform employs robust security principles, including but not limited to:</p>
<ul>
<li>encryption of data at rest and in transit</li>
<li>restricting access to resources according to operational needs</li>
<li>strict authorisation requirements for all endpoints</li>
<li><a href="rbac.html">role based access control</a></li>
</ul>
<p>The Platform is spread across multiple availability zones, which are essentially three different data centres within a region. In case of an entire AWS region going down for a prolonged period of time, the Platform can be recreated in another region within a few hours.</p>
<p>The recovery of products hosted on the Platform are subject to considerations set out for the Production Ready criteria in <a href="service-lifecycle.html">Service Lifecycle</a>.</p>
<p>For further information on security and disaster recovery considerations, please raise a ticket on the <a href="https://support.acp.homeoffice.gov.uk/servicedesk">Support Portal</a>.</p>
<h2 id="reusable-components">Reusable components<a class="headerlink" href="#reusable-components" title="Permanent link">#</a></h2>
<p>Whilst building ACP, we've written a things that other projects may be interested in reusing. These can be found on GitHub here</p>
<h4 id="terraform-modules"><a href="https://github.com/UKHomeOffice?utf8=%E2%9C%93&amp;q=acp-tf&amp;type=&amp;language=">Terraform modules</a><a class="headerlink" href="#terraform-modules" title="Permanent link">#</a></h4>
<h4 id="base-docker-images"><a href="https://github.com/UKHomeOffice?utf8=%E2%9C%93&amp;q=docker-&amp;type=&amp;language=">Base docker images</a><a class="headerlink" href="#base-docker-images" title="Permanent link">#</a></h4>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="index.html" title="Home" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Home
              </div>
            </div>
          </a>
        
        
          <a href="how-to-docs/index.html" title="How To's" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                How To's
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="assets/javascripts/vendor.22b62ea4.min.js"></script>
      <script src="assets/javascripts/bundle.5f27aba8.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: ".",
          features: [],
          search: Object.assign({
            worker: "assets/javascripts/worker/search.f6ebf1dc.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>